/*Выберите список бронирований на 14 сентября 2012 г., чтоимость 
которых более 30. Включите в выходные данные название заведения, имя 
участника, отформатированное как одиночное столбец и стоимость. 
Упорядочивайте по убыванию стоимости и не используйте подзапросы.
Помните, что у гостей разные затраты по сравнению с участниками 
(указанные затраты указаны за получасовой «интервал»), а идентификатор 
гостя всегда имеет идентификатор 0*/
USE cd;
SELECT DISTINCT concat(fac.facility, ' ', mem.firstname) AS 'Заведение и имя', CASE
WHEN mem.memid = 0 THEN fac.guestcost
ELSE fac.membercost
END AS 'Стоимость'
FROM members mem 
JOIN bookings book ON mem.memid = book.memid
JOIN facilities fac ON fac.facid = book.facid WHERE DATE(book.starttime) = '2012-09-14' AND fac.membercost > 30 AND fac.guestcost > 30;